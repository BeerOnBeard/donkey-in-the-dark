<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      :root {
        --cursor-x: -1000px;
        --cursor-y: -1000px;
        --flashlight-width: 0px;
        --flashlight-height: 0px;
        --character-width: 0;
        --character-height: 0;
        --character-x: 0;
        --character-y: 0;
        --character: 'donkey';
      }
      html, body, #root {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        cursor: crosshair;
      }
      body > svg {
        display: none;
      }
      .start, .play-again {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-flow: column;
      }
      .game {
        width: 100%;
        height: 100%;
        background: radial-gradient(
          var(--flashlight-width) var(--flashlight-height) at var(--cursor-x) var(--cursor-y),
          rgba(0,0,0,0) 0%,
          rgba(0,0,0,0.5) 80%,
          rgba(0,0,0,1) 100%
        )
      }
      .character-name:before {
        content: var(--character);
      }
      .character {
        width: var(--character-width);
        height: var(--character-height);
        position: absolute;
        z-index: -1;
        top: var(--character-y);
        left: var(--character-x);
      }
      .character-chooser__character {
        height: 12rem;
        width: 13rem;
        display:inline-block;
        text-align: center;
      }
      .character-chooser__character > button {
        margin: auto;
      }
      .character-chooser__character > svg {
        display: block;
        height: 12rem;
        width: 13rem;
      }
      .character-chooser__character--selected {
        fill: green;
      }
    </style>
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs>

<symbol id="dinosaur" viewBox="0 0 800 800">
  <g transform="matrix(1.3333333,0,0,-1.3333333,0,800)">
    <path d="m 464.739,263.882 c -1.247,0.838 -2.559,1.766 -3.916,2.768 -0.769,0.576 -1.554,1.182 -2.344,1.804 l -1.764,-7.268 c 0.3,-0.13 0.602,-0.261 0.897,-0.389 0.892,-0.339 1.763,-0.648 2.601,-0.942 0.864,-0.244 1.684,-0.497 2.485,-0.699 1.613,-0.377 3.099,-0.641 4.432,-0.779 1.331,-0.137 2.495,-0.186 3.457,-0.159 0.957,0.004 1.719,0.109 2.224,0.163 0.511,0.063 0.781,0.132 0.781,0.132 0,0 -0.979,0.508 -2.567,1.44 -1.593,0.926 -3.796,2.258 -6.286,3.929 m -12.502,-0.446 c 0.295,-0.173 0.592,-0.331 0.891,-0.493 l 2.008,8.27 c -0.176,0.151 -0.364,0.295 -0.526,0.453 -0.331,0.299 -0.65,0.612 -0.993,0.899 -0.34,0.296 -0.67,0.565 -1.049,0.944 l -1.106,1.063 -1.065,0.985 c -0.743,0.69 -1.482,1.394 -2.27,2.048 l -3.103,-8.242 -1.365,0.516 c 0.27,-0.237 0.543,-0.465 0.81,-0.705 l 1.233,-1.075 1.184,-0.974 c 0.368,-0.318 0.845,-0.665 1.293,-0.999 0.447,-0.343 0.913,-0.655 1.362,-0.979 0.911,-0.639 1.797,-1.172 2.696,-1.711 m -14.419,11.231 c 1.303,-0.978 2.594,-2.019 3.868,-3.095 l 3.216,8.541 c -0.76,0.536 -1.524,1.063 -2.306,1.555 -0.918,0.602 -1.879,1.123 -2.833,1.627 -0.949,0.516 -1.919,0.965 -2.884,1.38 -1.278,0.549 -2.559,1.006 -3.823,1.389 l -2.434,-6.589 c 0.884,-0.518 1.776,-1.056 2.678,-1.633 0.741,-0.502 1.493,-1.011 2.257,-1.529 0.758,-0.524 1.502,-1.088 2.261,-1.646 m -13.195,7.89 c 0.818,-0.36 1.67,-0.77 2.536,-1.203 l 2.082,5.64 c -1.203,0.221 -2.373,0.373 -3.478,0.444 -3.358,0.234 -6.148,-0.182 -8.01,-0.693 -0.936,-0.243 -1.645,-0.546 -2.117,-0.738 -0.474,-0.205 -0.709,-0.352 -0.709,-0.352 0,0 0.272,-0.043 0.762,-0.141 0.493,-0.084 1.204,-0.276 2.08,-0.502 1.754,-0.475 4.164,-1.266 6.854,-2.455 m -9.696,63.798 c 0,0 -1.517,0.346 -4.363,0.992 -2.85,0.613 -6.994,1.681 -12.241,3.101 -4.832,1.308 -10.564,3.095 -17.024,5.281 -0.558,0.188 -1.109,0.374 -1.677,0.568 -0.853,0.293 -1.72,0.599 -2.598,0.911 -6.461,2.306 -13.518,5.112 -21.103,8.241 -4.314,1.789 -8.807,3.654 -13.457,5.584 -2.334,0.961 -4.728,1.897 -7.182,2.834 -1.245,0.444 -2.501,0.893 -3.766,1.345 -1.265,0.406 -2.541,0.816 -3.825,1.228 -10.311,3.081 -21.392,5.764 -33.052,7.479 -11.654,1.698 -23.867,2.572 -36.269,2.089 -12.394,-0.479 -24.954,-2.231 -37.191,-5.307 -12.231,-3.104 -24.097,-7.566 -35.242,-12.993 -0.41,-0.198 -0.81,-0.408 -1.217,-0.609 -2.778,-1.369 -5.504,-2.803 -8.181,-4.294 -4.939,-2.75 -9.716,-5.68 -14.312,-8.738 -2.513,-1.672 -4.975,-3.379 -7.384,-5.111 -0.112,-0.082 -0.221,-0.164 -0.334,-0.245 -4.691,-3.386 -9.172,-6.886 -13.447,-10.44 -2.475,-2.058 -4.874,-4.133 -7.215,-6.214 -1.742,-1.547 -3.455,-3.098 -5.123,-4.647 -2.581,-2.383 -5.064,-4.764 -7.473,-7.13 -2.342,-2.3 -4.609,-4.584 -6.797,-6.839 -2.454,-2.525 -4.816,-5.018 -7.088,-7.451 -1.683,-1.795 -3.315,-3.558 -4.904,-5.289 -2.298,-2.504 -4.5,-4.932 -6.61,-7.264 -1.968,-2.178 -3.861,-4.277 -5.676,-6.268 -2.287,-2.498 -4.447,-4.832 -6.496,-6.993 -2.535,-2.669 -4.899,-5.066 -7.091,-7.111 -0.062,-0.06 -0.122,-0.111 -0.184,-0.169 -3.877,-3.611 -7.228,-6.138 -9.75,-7.489 -1.272,-0.7 -2.313,-1.113 -3.026,-1.351 -0.712,-0.241 -1.093,-0.329 -1.093,-0.329 0,0 0.384,0.066 1.112,0.263 0.731,0.197 1.802,0.547 3.127,1.178 2.661,1.241 6.303,3.609 10.465,7.163 4.183,3.53 8.968,8.136 14.302,13.539 5.315,5.406 11.313,11.505 17.856,18.159 6.587,6.585 13.828,13.602 21.787,20.663 7.969,7.045 16.697,14.094 26.158,20.746 9.469,6.637 19.752,12.756 30.649,18.023 10.901,5.26 22.485,9.509 34.383,12.527 11.891,3.049 24.106,4.813 36.189,5.335 12.085,0.56 24.035,-0.063 35.489,-1.585 11.449,-1.554 22.429,-3.835 32.669,-6.669 1.27,-0.378 2.533,-0.754 3.785,-1.126 1.228,-0.409 2.446,-0.817 3.656,-1.219 2.426,-0.847 4.824,-1.702 7.171,-2.588 4.699,-1.788 9.242,-3.516 13.604,-5.174 8.733,-3.337 16.857,-6.136 24.134,-8.351 3.646,-1.088 7.055,-2.105 10.249,-2.902 3.176,-0.86 6.122,-1.535 8.779,-2.149 2.647,-0.657 5.054,-1.059 7.125,-1.495 2.071,-0.438 3.852,-0.713 5.291,-0.961 2.878,-0.488 4.411,-0.749 4.411,-0.749 M 304.635,274.529 c 0,0 -13.049,-1.33 -15.488,-2.306 0,0 -4.216,-14.714 -2.267,-15.69 1.95,-0.974 14.261,1.49 16.292,3.197 0.557,0.468 1.463,14.799 1.463,14.799 m -20.724,-2.446 c 0,0 -14.709,0.65 -17.148,-0.325 0,0 -4.665,-15.114 -2.715,-16.091 1.951,-0.975 15.719,-0.338 19.227,0.175 0.718,0.106 0.636,16.241 0.636,16.241 m -22.064,0.213 c 0,0 -12.393,2.847 -14.832,1.871 0,0 -7.72,-13.379 -5.77,-14.355 1.951,-0.975 17.392,-3.206 18.042,-3.53 0.65,-0.324 2.56,16.014 2.56,16.014 m -75.563,-8.364 c 2.301,4.093 4.526,7.805 4.656,9.371 0.325,3.9 -7.964,26.006 -34.783,49.898 11.628,-11.534 34.699,-41.56 26.197,-58.126 1.252,-0.391 2.566,-0.774 3.93,-1.143 m -6.765,2.085 c 1.519,1.909 3.054,4.096 2.564,4.604 -0.912,0.938 -9.018,4.855 -9.321,5.167 -0.175,0.182 -1.961,-2.879 -3.454,-5.521 -1.112,-1.967 -2.061,-3.704 -2.061,-3.704 0,0 8.113,-3.678 9.688,-3.61 0,0 1.286,1.43 2.584,3.064 m -12.676,3.57 c 1.492,2.305 4.026,6.454 3.374,7.128 -0.909,0.94 -10.291,4.394 -10.727,4.396 -1.927,0.007 -2.439,-11.09 -2.439,-11.09 0,0 4.65,-1.32 7.291,-1.803 0.642,-0.119 1.17,-0.19 1.478,-0.176 0,0 0.433,0.633 1.023,1.545 m -10.973,12.33 c -1.302,0.13 -10.739,-1.332 -11.173,-1.289 -0.434,0.044 1.74,-10.607 1.74,-10.607 0,0 6.529,0.344 7.689,1.413 0,0 3.046,10.349 1.744,10.483 m -13.2,-1.664 c -1.302,0.133 -10.286,-3.481 -10.721,-3.436 -0.434,0.042 1.722,-10.633 1.722,-10.633 0,0 8.911,2.431 10.07,3.498 0,0 0.231,10.439 -1.071,10.571 m -10.543,-14.638 c 0,0 -0.774,9.153 -2.076,9.283 -1.301,0.129 -8.321,-4.932 -8.755,-4.889 -0.434,0.044 2.64,-8.99 2.64,-8.99 0,0 7.033,3.53 8.191,4.596 m -12.973,2.663 c 0,0 -6.745,-4.052 -7.819,-5.205 0,0 1.465,-9.066 2.773,-9.098 1.308,-0.032 7.924,5.548 8.359,5.538 0.437,-0.01 -3.313,8.765 -3.313,8.765 m -9.315,-5.888 c 0,0 -8.701,-3.101 -9.776,-4.252 0,0 0.561,-10.428 1.869,-10.459 1.309,-0.033 9.992,4.251 10.429,4.239 0.436,-0.01 -2.522,10.472 -2.522,10.472 m -12.44,-4.795 c 0,0 -8.706,-1.743 -9.781,-2.896 0,0 0.685,-11.218 1.992,-11.251 1.309,-0.03 9.893,3.713 10.328,3.702 0.437,-0.01 -2.539,10.445 -2.539,10.445 M 87.31,242.54 l -2.344,11.435 -6.826,-1.534 1.665,-11.408 z m -9.776,-1.911 -2.212,11.812 -7.436,-1.813 2.062,-11.01 z m -9.923,-1.257 -1.165,10.937 -7.555,-1.221 1.079,-10.128 z m -10.035,-0.456 -0.097,9.98 -7.635,-0.491 0.088,-9.166 z m -9.341,9.466 c 0,0 -1.745,0.04 -3.489,0.081 -0.462,0.027 -0.95,0.075 -1.394,0.109 -0.445,0.037 -0.862,0.071 -1.22,0.101 -0.716,0.059 -1.192,0.098 -1.192,0.098 l -1.106,-8.075 c 0,0 0.47,-0.089 1.175,-0.224 0.351,-0.066 0.763,-0.146 1.204,-0.229 0.443,-0.083 0.9,-0.179 1.388,-0.261 2.062,-0.275 4.125,-0.548 4.125,-0.548 z m -8.965,0.591 c 0,0 -1.704,0.282 -3.406,0.564 -0.452,0.096 -0.927,0.222 -1.359,0.324 -0.436,0.108 -0.842,0.206 -1.191,0.291 -0.697,0.171 -1.162,0.284 -1.162,0.284 l -2.058,-6.829 c 0,0 0.449,-0.162 1.125,-0.405 0.337,-0.122 0.731,-0.264 1.153,-0.415 0.426,-0.149 0.861,-0.317 1.332,-0.472 2.021,-0.571 4.041,-1.142 4.041,-1.142 z m -11.176,-4.542 2.469,6.473 c 0,0 -1.611,0.575 -3.222,1.152 -0.205,0.076 -0.43,0.195 -0.64,0.289 -0.214,0.098 -0.424,0.196 -0.627,0.291 -0.407,0.188 -0.786,0.366 -1.112,0.516 -0.649,0.303 -1.083,0.505 -1.083,0.505 l -2.874,-5.397 c 0,0 0.41,-0.247 1.025,-0.616 0.305,-0.185 0.664,-0.401 1.048,-0.633 0.193,-0.115 0.391,-0.235 0.592,-0.356 0.208,-0.121 0.394,-0.248 0.625,-0.366 1.899,-0.928 3.799,-1.858 3.799,-1.858 m -8.889,5.058 3.231,4.95 c 0,0 -1.439,0.913 -2.877,1.826 -0.184,0.12 -0.372,0.291 -0.555,0.431 -0.184,0.148 -0.364,0.294 -0.54,0.434 -0.278,0.225 -0.536,0.432 -0.775,0.623 -0.059,0.047 -0.123,0.1 -0.179,0.145 -0.559,0.449 -0.931,0.748 -0.931,0.748 l -0.153,-0.168 -3.25,-3.626 c 0,0 0.339,-0.337 0.847,-0.843 0.254,-0.253 0.55,-0.549 0.868,-0.865 0.158,-0.16 0.324,-0.323 0.49,-0.488 0.172,-0.166 0.323,-0.337 0.518,-0.504 1.654,-1.332 3.306,-2.663 3.306,-2.663 m -7.46,7.005 3.215,2.895 0.421,0.379 c 0,0 -1.082,1.193 -2.196,2.421 -0.034,0.039 -0.068,0.076 -0.102,0.113 -0.144,0.169 -0.274,0.386 -0.41,0.571 -0.134,0.193 -0.266,0.384 -0.395,0.569 -0.255,0.368 -0.494,0.711 -0.698,1.006 -0.409,0.589 -0.682,0.984 -0.682,0.984 l -3.471,-2.143 c 0,0 0.229,-0.42 0.574,-1.049 0.171,-0.315 0.373,-0.683 0.587,-1.076 0.108,-0.195 0.219,-0.399 0.332,-0.606 0.118,-0.207 0.214,-0.415 0.355,-0.628 z m -5.193,8.773 3.526,1.606 c 0,0 -0.193,0.401 -0.484,1.004 -0.143,0.304 -0.329,0.651 -0.472,1.044 -0.157,0.39 -0.324,0.805 -0.491,1.221 -0.143,0.411 -0.267,0.822 -0.397,1.21 -0.136,0.371 -0.236,0.775 -0.316,1.129 -0.168,0.698 -0.28,1.163 -0.28,1.163 l -3.011,-0.557 c 0,0 0.062,-0.474 0.156,-1.186 0.04,-0.35 0.096,-0.766 0.209,-1.257 0.099,-0.477 0.199,-0.996 0.318,-1.501 0.138,-0.491 0.275,-0.98 0.403,-1.439 0.119,-0.466 0.283,-0.877 0.408,-1.238 0.258,-0.72 0.431,-1.199 0.431,-1.199 m -2.052,9.893 2.851,0.201 c 0,0 -0.08,0.887 -0.16,1.776 0.001,0.974 0.002,1.949 0.002,1.949 l -2.44,0.135 c 0,0 -0.103,-0.971 -0.208,-1.943 C 4.522,276.22 4.5,275.16 4.5,275.16 m 383.156,-4.066 6.808,5.852 c -2.803,-1.276 -5.12,-3.123 -6.692,-5.675 -0.037,-0.06 -0.078,-0.118 -0.116,-0.177 m 99.101,-16.647 c -12.922,-4.386 -35.839,0.734 -43.397,11.216 -4.264,5.914 -18.303,11.983 -31.484,13.304 0.007,0.151 0.013,0.303 0.022,0.454 -0.06,1.107 -0.009,2.234 -0.194,3.376 -0.213,2.287 -0.819,4.613 -1.699,6.838 -0.874,2.232 -2.081,4.359 -3.551,6.252 -1.459,1.9 -3.131,3.607 -4.915,5.087 -1.804,1.462 -3.699,2.71 -5.6,3.779 -1.912,1.052 -3.833,1.901 -5.68,2.617 -1.866,0.673 -3.645,1.25 -5.323,1.642 -1.666,0.425 -3.219,0.697 -4.597,0.902 -1.379,0.195 -2.583,0.327 -3.583,0.379 -0.994,0.079 -1.776,0.087 -2.307,0.095 -0.533,0.008 -0.818,0.013 -0.818,0.013 0,0 0.283,-0.028 0.814,-0.08 0.53,-0.05 1.309,-0.121 2.288,-0.277 0.981,-0.131 2.163,-0.36 3.507,-0.66 1.341,-0.312 2.845,-0.703 4.443,-1.252 1.608,-0.512 3.296,-1.218 5.047,-2.011 1.732,-0.838 3.512,-1.805 5.249,-2.951 1.727,-1.164 3.416,-2.485 4.976,-3.974 1.545,-1.507 2.939,-3.187 4.104,-4.991 1.179,-1.797 2.08,-3.746 2.677,-5.736 0.6,-1.983 0.961,-3.998 0.981,-5.965 0.084,-0.979 -0.052,-1.953 -0.066,-2.891 -0.02,-0.131 -0.036,-0.26 -0.053,-0.387 -1.858,0.031 -3.668,-0.057 -5.41,-0.261 -0.319,-0.445 -0.657,-0.894 -1.024,-1.347 0.035,0.481 0.065,0.968 0.081,1.463 0.008,1.151 -0.046,2.339 -0.177,3.544 -0.121,1.108 -0.307,2.232 -0.589,3.356 -0.608,2.332 -1.528,4.652 -2.778,6.809 -1.279,2.141 -2.839,4.116 -4.57,5.886 -1.726,1.781 -3.676,3.292 -5.647,4.654 -1.973,1.368 -4.046,2.483 -6.078,3.473 -2.03,1.001 -4.077,1.759 -6.015,2.451 -1.961,0.635 -3.825,1.189 -5.578,1.572 -1.74,0.415 -3.359,0.69 -4.795,0.895 -1.436,0.199 -2.692,0.337 -3.732,0.392 -1.037,0.08 -1.851,0.096 -2.407,0.101 -0.555,0.01 -0.851,0.016 -0.851,0.016 0,0 0.295,-0.028 0.848,-0.082 0.553,-0.048 1.365,-0.127 2.386,-0.285 1.022,-0.134 2.258,-0.367 3.66,-0.674 1.401,-0.31 2.974,-0.707 4.653,-1.245 1.689,-0.507 3.472,-1.193 5.331,-1.958 1.836,-0.82 3.761,-1.708 5.637,-2.822 1.879,-1.102 3.775,-2.317 5.531,-3.751 1.756,-1.428 3.46,-2.97 4.901,-4.715 1.451,-1.733 2.699,-3.604 3.67,-5.551 0.939,-1.964 1.558,-4 1.922,-5.997 0.339,-2.005 0.343,-3.975 0.191,-5.825 -0.017,-0.156 -0.043,-0.305 -0.064,-0.46 -0.097,-0.761 -0.217,-1.506 -0.343,-2.221 -0.228,-0.857 -0.393,-1.688 -0.642,-2.47 -0.268,-0.776 -0.525,-1.522 -0.769,-2.229 -0.208,-0.476 -0.403,-0.929 -0.595,-1.37 -7.256,-6.765 -15.702,-13.593 -15.837,-18.321 -0.244,-8.534 -1.707,-24.137 5.851,-28.525 6.869,-3.988 4.316,-17.019 19.099,-22.755 1.542,-3.251 4.794,-2.194 5.647,-3.982 -1.997,0 -4.209,-0.167 -6.537,-0.38 0.631,-0.362 1.399,-0.918 1.539,-1.572 -1.162,-0.064 -3.57,0.49 -6.277,1.129 -0.864,-0.078 -1.732,-0.15 -2.607,-0.218 0.216,-0.973 0.44,-1.981 0.548,-2.484 -1.402,-0.078 -5.167,1.125 -9.105,2.298 -3.509,0.177 -6.889,0.775 -9.903,2.119 l -0.44,-0.012 c 0.123,0.019 0.254,0.028 0.392,0.035 -0.492,0.222 -0.986,0.446 -1.457,0.71 -9.753,5.444 -6.178,14.87 -13.981,16.984 -7.8,2.114 -15.925,28.931 -7.963,31.532 7.529,2.458 30.728,13.917 32.149,20.93 -10.945,-13.29 -33.281,-17.567 -42.795,-21.417 -10.239,-4.144 -15.726,-24.258 -16.456,-28.77 -0.733,-4.509 5.241,-15.358 8.532,-18.405 3.292,-3.049 9.144,-5.242 7.193,-8.778 -0.61,1.341 -7.315,4.998 -7.923,2.561 1.83,-0.733 2.681,-3.292 1.462,-5.608 0,0.853 -7.436,4.63 -8.045,2.925 -0.611,-1.707 -6.34,3.534 -5.486,1.341 1.097,-1.584 2.317,-5.119 -2.438,-7.192 0,0.732 -6.095,5.608 -7.802,5.242 -8.777,2.926 -19.505,18.651 -10.728,31.817 8.778,13.165 9.997,37.301 9.266,40.47 -0.732,3.17 4.631,8.534 9.995,13.143 5.364,4.608 12.922,13.677 29.014,29.281 -21.455,-15.604 -41.448,-27.958 -43.398,-47.299 -29.745,-12.19 -71.679,-0.488 -71.679,-0.488 0,0 7.151,9.077 4.226,20.317 6.827,22.454 13.734,60.14 6.948,75.255 2.194,-46.322 -14.343,-73.142 -11.417,-78.261 2.443,-4.279 2.5,-10.092 -4.092,-16.759 l 3.054,-1.117 c -1.633,-1.469 -4.325,-2.311 -7.587,-2.792 -0.051,-0.04 -0.101,-0.078 -0.153,-0.117 -11.215,-8.35 -21.943,-31.633 -23.649,-37.974 -2.454,-9.116 7.438,-13.474 11.215,-16.089 0.582,-0.403 1.477,-1.156 2.278,-2.097 2.792,-0.473 10.195,-1.935 11.05,-4.302 -1.623,0 -7.566,-0.73 -9.519,-0.976 -0.074,-0.184 -0.163,-0.369 -0.274,-0.549 2.804,-0.976 5.974,-5.851 4.755,-6.826 -0.854,1.462 -4.877,3.169 -10.118,2.194 -2.073,-2.562 -8.777,0.608 -10.85,3.535 0.123,1.341 -2.072,9.143 -3.9,7.315 1.218,-1.585 2.925,-4.999 1.828,-6.83 1.707,-1.338 0.609,-6.824 -1.95,-7.19 0.365,3.534 -4.389,3.291 -4.389,3.291 0,0 1.463,-0.976 -2.682,-0.608 -4.144,0.365 -8.046,8.167 -7.68,15.967 0.366,7.802 -4.307,5.04 -4.957,17.392 5.044,7.285 9.356,21.325 7.33,27.146 -6.885,-4.364 -14.314,-10.066 -13.964,-16.529 0.433,-8.011 -14.447,-8.725 -8.207,-26.326 1.416,-2.7 2.911,-6.279 1.799,-7.759 -0.662,1.01 -1.993,2.536 -2.926,3.568 -0.124,-1.916 0.033,-3.689 -0.567,-4.677 -2.945,4.124 -5.488,6.439 -7.576,8.108 -0.213,-1.527 -0.621,-3.136 -1.404,-4.18 -0.084,1.785 -0.645,4.056 -1.379,6.345 -2.021,1.639 -3.274,3.163 -3.639,6.859 -1.242,2.834 -2.159,9.036 -2.359,11.85 -0.798,11.254 9.146,13.452 6.612,21.215 -1.427,4.371 3.71,13.165 9.65,19.07 -9.417,4.13 -14.076,8.18 -38.145,-8.445 -67.778,-46.809 -170.176,0.488 -91.671,57.54 -2.669,-9.134 -25.861,-30.824 -11.303,-44.057 l 9.02,12.08 c 1.667,-1.244 3.306,-2.13 4.869,-2.633 l -4.727,-14.706 c 0.227,-0.086 0.445,-0.176 0.678,-0.259 5.937,-2.148 12.1,-1.781 18.417,0.433 l -5.34,15.058 c 1.982,0.702 4.16,1.761 6.477,3.146 l 8.2,-13.721 c 4.774,2.86 9.61,6.557 14.483,10.831 l -10.339,12.06 c 2.137,1.833 4.375,3.848 6.844,6.158 l 10.75,-11.484 c 4.084,3.985 8.184,8.274 12.28,12.719 l -10.797,10.726 c 2.229,2.243 4.499,4.55 6.814,6.904 l 10.555,-10.382 c 3.908,4.365 7.805,8.792 11.674,13.153 l -9.8,9.802 c 2.307,2.306 4.658,4.635 7.054,6.972 l 9.262,-9.496 c 4.064,4.49 8.088,8.817 12.056,12.819 l -8.244,9.036 c 2.528,2.305 5.057,4.558 7.52,6.697 l 7.77,-8.947 c 4.522,4.162 8.945,8.008 13.295,11.57 l -6.987,8.978 c 2.719,2.116 5.462,4.177 8.151,6.124 l 6.539,-9.032 c 4.91,3.711 9.74,7.057 14.521,10.071 l -5.737,9.257 c 2.945,1.825 5.934,3.588 8.887,5.239 l 5.301,-9.475 c 5.321,2.961 10.605,5.531 15.902,7.754 l -4.544,10.119 c 3.172,1.424 6.404,2.775 9.605,4.016 l 4.119,-10.635 c 5.592,1.934 11.228,3.52 16.962,4.814 l -3.25,11.735 c 3.354,0.928 6.77,1.771 10.155,2.504 l 2.675,-12.349 c 5.651,0.953 11.421,1.667 17.363,2.184 l -1.473,13.203 c 3.43,0.382 6.932,0.675 10.408,0.867 l 0.743,-13.402 c 2.702,0.143 5.437,0.259 8.22,0.343 3.127,0.093 6.208,0.085 9.247,-0.011 l 0.546,13.193 c 3.422,-0.142 6.91,-0.375 10.37,-0.697 l -1.211,-13.103 c 5.94,-0.558 11.707,-1.441 17.31,-2.566 l 2.359,13.155 c 3.334,-0.598 6.733,-1.284 10.098,-2.042 l -2.982,-13.27 c 5.767,-1.469 11.348,-3.166 16.739,-4.997 l 4.093,13.564 c 3.208,-0.968 6.477,-2.02 9.721,-3.128 l -4.687,-13.716 c 5.604,-2.114 10.995,-4.319 16.176,-6.501 l 5.648,13.772 c 3.091,-1.267 6.223,-2.606 9.311,-3.98 l -6.051,-13.587 c 5.655,-2.423 11.033,-4.716 16.147,-6.711 l 6.314,12.491 c 2.941,-1.486 5.946,-3.052 8.929,-4.654 l -6.001,-11.167 c 4.571,-1.481 8.9,-2.581 12.995,-3.152 l 4.712,11.589 5.091,-11.808 c 1.771,0.206 3.494,0.554 5.159,1.08 10.576,-48.923 58.421,-44.21 41.598,-59.325 -6.362,-5.718 -7.522,-12.294 -5.021,-19.02 -0.002,10e-4 -0.004,10e-4 -0.005,0.002 10e-4,-10e-4 0.004,-0.002 0.005,-0.003 4.11,-11.056 18.123,-22.513 35.253,-31.205 m 6.529,1.731 c -2.085,2.983 -3.917,6.106 -5.595,9.29 -2.954,5.661 -5.398,11.513 -7.56,17.43 -0.584,-0.252 -1.161,-0.464 -1.729,-0.617 -1.377,-0.384 -2.722,-0.593 -4.061,-0.736 -2.678,-0.234 -5.308,-0.205 -7.919,-0.016 -0.653,0.037 -1.303,0.119 -1.952,0.19 -0.648,0.077 -1.295,0.167 -1.942,0.264 -1.288,0.205 -2.573,0.428 -3.839,0.741 -0.723,0.177 -1.44,0.38 -2.152,0.596 5.189,-9.795 20.357,-19.027 36.562,-31.553 3.17,-2.451 6.236,-4.356 9.201,-5.821 -0.657,0.604 -1.339,1.186 -1.97,1.814 -2.642,2.58 -4.97,5.432 -7.044,8.418 m -12.869,49.225 c -18.839,6.511 -24.623,-8.533 -24.623,-8.533 v -0.976 c -1.666,-4.036 -1.443,-7.778 0.183,-11.424 0.976,-0.152 1.954,-0.269 2.935,-0.341 2.519,-0.2 5.047,-0.227 7.557,-0.105 2.503,0.091 5.004,0.342 7.395,0.821 1.197,0.222 2.37,0.509 3.431,0.899 0.538,0.19 1.023,0.423 1.452,0.663 0.406,0.248 0.748,0.53 0.888,0.732 l 1.89,2.758 1.457,-3.293 c 1.418,-3.21 2.831,-6.41 4.306,-9.566 1.486,-3.149 3.011,-6.268 4.665,-9.3 1.641,-3.036 3.402,-5.991 5.317,-8.814 0.963,-1.406 1.963,-2.783 3.011,-4.112 1.048,-1.331 2.163,-2.595 3.308,-3.824 0.57,-0.618 1.187,-1.181 1.779,-1.776 l 1.868,-1.668 c 0.656,-0.508 1.3,-1.039 1.967,-1.533 0.692,-0.455 1.355,-0.964 2.063,-1.392 1.406,-0.873 2.865,-1.679 4.403,-2.304 l 0.668,-0.279 c 10.829,-0.614 19.328,4.609 24.545,9.974 -38.278,-2.682 -31.531,43.398 -60.465,53.393 m 21.032,23.64 c -2.136,2.404 -5.338,3.045 -7.15,1.435 -1.81,-1.611 -1.545,-4.865 0.593,-7.267 2.136,-2.402 5.337,-3.045 7.149,-1.435 1.811,1.611 1.545,4.866 -0.592,7.267 m 55.524,-58.505 c 9.997,-15.114 0.244,-27.549 -9.996,-29.012 4.388,16.823 -28.769,20.481 -37.058,38.522 -8.29,18.042 -23.812,38.765 -48.518,28.039 1.301,15.277 -37.709,24.705 -45.51,59.486 -7.801,34.783 33.807,76.393 51.524,54.613 -22.267,-12.028 0.631,-53.16 9.408,-69.089 -26.353,1.71 -38.308,12.77 -41.1,25.204 0.323,-35.434 50.059,-26.981 63.386,-31.946 -1.787,-8.784 -0.893,-12.669 12.517,-23.397 0.487,-27.55 39.008,-11.702 41.689,-21.942 -12.677,-3.901 -6.338,-15.361 3.658,-30.478 m 43.397,64.123 c -2.437,5.241 -74.004,-0.762 -87.9,-7.832 -11.15,9.109 -10.353,17.584 -10.353,17.584 22.917,2.437 90.207,5.241 98.253,-9.752"/>
  </g>
</symbol>
        
<symbol id="donkey" viewBox="0 0 1052.3622 744.0945">
  
  <g
     id="layer1"
     transform="translate(0,-308.26772)">
    <g
       id="g4179"
       transform="matrix(-0.373248,0,0,0.373248,634.90646,177.34679)">
      <path
         d="m 1443.859,545.25788 c 0,0 -78.7837,62.78178 -112.3958,83.24133"
         id="path4169"
      />
      <path
         d="m 1569.539,447.34437 c 0,0 -17.428,-10.86642 -31.8951,7.21743 -14.4671,18.08385 -94.5527,89.38589 -94.5527,89.38589 0,0 41.8512,-49.60142 40.3012,-66.65191 -1.5501,-17.05048 -12.4004,-26.35075 -25.8341,-27.90079 -13.4337,-1.55005 -31.0009,20.15057 -34.6177,26.86743 -3.6167,6.71686 -59.935,73.36876 -66.6519,80.08562 -6.7168,6.71686 -38.7511,40.81783 -44.9513,42.88456 -6.2001,2.06672 -36.6843,7.23354 -61.485,7.23354 -24.8007,0 -129.6871,-5.16682 -175.155,0 -45.468,5.16681 -93.51938,7.75022 -150.87102,26.86743 -57.35164,19.11721 60.45173,-23.76734 -80.08562,22.2173 -140.53735,45.98465 -267.64097,110.56983 -316.72571,136.4039 -49.08474,25.83407 -43.91792,21.18394 -59.41836,28.41748 -15.50045,7.23354 -29.96753,33.58429 -79.05226,35.13433 -49.08474,1.55005 -133.82049,8.78359 -248.52376,-3.10009 C 25.31739,840.52282 -37.201062,837.93941 -119.87009,817.27216 -202.53912,796.6049 -328.30781,769.15203 -381.526,763.46854 c -104.35672,-19.34069 -219.83289,-2.33347 -297.91007,53.28694 -55.28491,39.78447 -101.78624,70.78535 -128.65367,125.55358 -26.86744,54.76823 -38.75111,97.65284 -35.13434,148.28754 3.61677,50.6348 15.50044,248.5238 8.2669,284.6915 -7.23354,36.1677 -11.88367,85.7691 -40.30115,128.137 -28.41748,42.3679 -83.70239,101.2695 -88.35252,108.5031 -4.65013,7.2335 -8.2669,27.3841 16.5338,22.2173 24.80071,-5.1668 64.0685,-23.2507 84.73576,-51.6682 20.66725,-28.4174 59.41836,-72.3354 71.30203,-144.6708 11.88368,-72.3354 10.85031,-114.7032 13.43372,-156.0377 2.58341,-41.3346 -3.10009,-87.3192 4.65013,-139.504 7.75022,-52.1849 8.26691,-52.7015 8.26691,-52.7015 0,0 25.31739,130.2037 25.83407,214.4228 0.51668,84.219 -2.06673,149.8376 -31.00089,198.9223 -28.93416,49.0847 -57.35164,88.8692 -82.15234,105.403 -24.80071,16.5338 -49.08474,36.1677 -50.63478,55.8016 -1.55005,19.6339 -12.91704,41.8512 -21.70062,103.853 -8.78359,62.0017 -47.53469,204.6058 -57.35164,238.1901 -9.81695,33.5843 -16.53381,52.1848 -19.1172,67.1686 -2.5834,14.9838 -5.1668,27.3841 9.81693,40.8178 14.98376,13.4337 52.18483,36.6844 57.35164,52.1848 5.16682,15.5005 10.85031,37.2011 11.36699,51.1515 0.51668,13.9504 -3.10009,41.3345 -3.10009,41.3345 0,0 31.00089,10.3337 56.83496,13.9504 25.83407,3.6168 76.46885,3.1001 76.46885,3.1001 l -22.73398,-89.9026 c 0,0 1.55004,-4.6501 2.06672,-7.7502 0.51669,-3.1001 0,-14.9837 -9.30026,-27.3841 -9.30027,-12.4003 -32.55093,-29.4508 -34.61766,-49.6014 -2.06672,-20.1506 -3.10009,-80.6023 21.70062,-146.7375 24.80071,-66.1353 35.13434,-87.3192 82.15235,-169.9882 47.01801,-82.669 101.78624,-176.7051 187.03867,-273.3245 85.25244,-96.6194 120.38677,-128.137 120.38677,-128.137 l 5.16682,3.6168 c 0,0 37.20106,31.0009 39.26779,29.9675 2.06672,-1.0334 10.33363,-14.9838 17.05048,-20.1506 6.71686,-5.1668 14.98377,-10.8503 24.80071,-3.6167 9.81695,7.2335 13.9504,18.0838 69.23531,51.6681 l 55.28491,33.5843 c 0,0 80.08562,51.6681 145.187484,67.1686 65.101859,15.5004 152.937701,29.4508 249.557126,18.0838 96.61943,-11.367 142.08739,-16.0171 198.92235,-26.3507 56.83495,-10.3337 138.9873,-26.3508 177.22173,-28.4175 38.23442,-2.0667 39.26778,-2.0667 39.26778,-2.0667 0,0 -4.65013,-24.8007 18.08385,108.5031 22.73399,133.3038 22.73399,183.9386 33.5843,210.806 10.85031,26.8674 11.36699,26.8674 11.36699,26.8674 0,0 21.18394,46.5014 25.31739,102.8196 4.13345,56.3183 2.06672,133.3038 13.9504,148.2876 11.88367,14.9838 15.50044,22.2173 32.03424,30.4842 16.53381,8.2669 17.56717,12.917 22.2173,20.1506 4.65014,7.2335 16.53381,73.3687 16.53381,73.3687 0,0 1.55004,5.1669 9.81695,7.2336 8.2669,2.0667 45.46796,5.1668 53.21818,5.1668 7.75022,0 27.38412,-1.5501 27.38412,-1.5501 0,0 -4.13345,19.6339 0.51668,22.2173 4.65013,2.5835 55.28491,11.367 83.70239,8.267 28.41748,-3.1001 27.9008,-3.1001 27.9008,-3.1001 0,0 -12.91704,-27.3842 -21.70062,-57.8684 -8.78359,-30.4842 -12.40036,-47.5346 -25.31739,-55.2849 -12.91704,-7.7502 -39.26779,-10.3336 -52.18483,-40.3011 -12.91703,-29.9675 -41.85119,-97.6528 -45.46796,-170.5049 -3.61677,-72.8521 -2.06673,-104.3696 -3.61677,-127.6203 -1.55005,-23.2507 2.06672,-30.4842 -7.75022,-81.6357 -9.81695,-51.1514 -19.6339,-101.7862 -22.2173,-151.3876 -2.58341,-49.6014 -6.68978,-91.7123 -6.20018,-141.054 0.15147,-15.2654 0,-20.1506 18.60053,-41.8512 1.55004,-1.0334 47.53469,-67.6853 64.0685,-103.3363 16.5338,-35.651 34.10097,-75.4355 68.71863,-101.7863 34.61765,-26.3507 92.48601,-59.935 134.33721,-73.3687 41.8512,-13.4337 75.4354,-23.2507 103.8529,-16.5338 28.4175,6.7168 41.8512,9.3002 62.5185,45.4679 20.6672,36.1677 68.2019,63.5518 81.119,68.7187 12.917,5.1668 53.7348,20.1505 68.2019,25.3173 14.4671,5.1669 54.7682,14.9838 68.202,18.0839 13.4337,3.1001 16.5338,5.1668 22.7339,5.1668 6.2002,0 13.9504,-5.1668 13.9504,-5.1668 0,0 4.6502,7.7502 13.9504,15.5004 9.3003,7.7503 63.0352,31.0009 71.8187,30.4842 8.7836,-0.5166 23.7674,-13.9504 23.2507,-21.1839 -0.5167,-7.2335 3.6168,-4.6501 -12.4003,-16.0171 -16.0172,-11.367 -36.1677,-29.4509 -37.7178,-42.3679 -1.55,-12.917 4.6501,-33.0676 5.6835,-35.1343 1.0334,-2.0668 -3.1001,-10.3337 2.0667,-1.5501 5.1669,8.7836 20.1506,33.0676 27.9008,39.7845 7.7503,6.7169 27.3841,27.3841 36.6844,27.3841 9.3003,0 24.8007,-12.4003 24.8007,-22.734 0,-10.3336 2.0667,-28.4175 2.5834,-38.2344 0.5167,-9.8169 2.0668,-5.1668 1.5501,-24.8007 -0.5167,-19.6339 -9.817,-42.8846 -20.6673,-55.2849 -10.8503,-12.4004 -72.8521,-83.7024 -82.669,-113.6699 -9.817,-29.96755 -23.7674,-50.11813 -21.184,-66.65194 2.5834,-16.5338 12.4004,-16.01712 -7.2335,-44.95128 -29.2156,-43.0545 -48.0514,-70.26867 -64.0685,-87.83584 -16.0171,-17.56717 -34.6176,-34.10097 -46.5013,-42.88456 -11.8837,-8.78358 -25.8341,-12.40035 -25.3174,-18.08385 0.5167,-5.68349 112.6365,-141.57071 141.054,-177.22172 28.4175,-35.65102 57.8683,-84.21908 61.4851,-91.45262 3.6168,-7.23354 6.7169,-16.5338 1.4109,-26.85132 z"
      />
      <path
         d="m -368.91053,1331.8869 c -19.11722,4.6501 -75.43549,50.1181 -75.43549,50.1181"
      />
      <path
         d="m -722.32063,1490.5081 c -10.33363,11.8836 -79.05226,106.4363 -95.58606,124.0035 -16.53381,17.5672 -49.60142,44.4346 -51.66814,47.018 -2.06673,2.5834 -12.40036,36.6844 -16.01713,55.8016 -3.61677,19.1172 -20.22933,109.8974 -26.35075,137.9539 -6.20017,28.4175 -13.9504,52.1849 -17.56717,65.1019"
      />
      <path
         d="m 623.63448,1497.2249 c 0,4.1335 63.03513,321.3759 76.98553,361.1603 13.9504,39.7845 35.13433,100.7529 42.36787,145.7042 7.23354,44.9513 19.6339,128.137 23.25067,139.504 3.61677,11.367 5.16681,20.1505 21.18394,23.7673 16.01712,3.6168 27.38411,1.5501 32.55093,6.2002 5.16681,4.6501 15.50044,38.7511 17.05048,44.9513 1.55005,6.2002 3.10009,19.6339 3.10009,19.6339"
      />
    </g>
  </g>
</symbol>

<symbol id="duck" viewBox="0 0 409.156 339.716">
  <path
      d="m33.588 70.703c9.503-1.647 18.38-4.807 27.535-7.743 10.538-3.38 18.243-2.232 29.739-1.105-1.896 19.755 1.565 39.415-2.755 58.903-4.196 18.928-17.169 34.678-19.272 54.48-4.014 37.786 21.413 73.222 53.047 90.87 14.503 8.092 30.264 14.863 46.625 18.089 21.02 4.144 37.852-0.608 58.922-1.105 9.956-0.234 20.047 3.468 29.882 1.351 10.215-2.199 20.495-4.158 30.667-6.543 13.186-3.091 43.527-5.853 51.793-16.38-0.888-0.197-1.882-0.19-2.756-0.551 5.632-2.055 36.808-16.517 18.726-23.23 15.934-11.285 40.07-17.891 53.416-30.974-21.322-2.114-50.294 10.255-71.589 14.935 13.112-7.143 27.398-11.129 39.648-19.913-13.98 3.663-56.821 23.404-61.676 4.424 11.421-2.048 22.059-5.171 33.04-8.849-3.499-0.702-8.499-2.842-11.989-1.966-4.232 1.063-12.427 5.021-16.645 4.179-7.33-1.465-19.267-13.641-26.371-17.801-18.017-10.553-37.271-18.496-57.332-24.234-18.787-5.375-36.664-10.718-56.17-7.744-14.946 2.279-31.002 5.938-43.506-4.979-14.354-12.528-12.665-33.795-12.665-51.137 0-17.898 10.813-29.613 16.246-45.93 10.253-30.797-31.015-57.56-57.548-44.246-12.935 6.467-20.004 20.493-28.913 31.225-10.309 12.42-22.498 11.888-37.447 13.551-6.56 0.73-16.242 1.623-16.242 10.51 0 13.316 24.382 11.383 33.588 11.89"
  />
  <path
      d="m215.32 272.58c1.325 5.712-3.708 11.103-2.468 16.084 1.763 7.081 5.144 17.08 1.917 24.293-7.031 15.721-31.695 10.945-45.158 13.826 5.158-0.149 9.227 3.376 10.467 8.297 10.898-10.287 7.508 1.123 13.768 3.871 5.188 2.277 10.832-1.349 17.069-0.552 10.445 1.334 8.302 2.246 17.622-0.554 5.889-1.769 13.836-2.664 19.272-5.53-7.177-2.582-14.07-6.423-21.475-7.745 8.105-19.753-0.854-36.911-3.307-57.521-2.27 1.96-5.82 3.75-7.71 5.52"
  />
  <path
      d="m168.51 277.56c-0.016 10.557 9.24 30.222 0 39.27-5.629 5.513-16.014 2.213-23.403 2.213-10.767 0-21.507 2.84-32.215 3.872 5.504-0.227 10.818 2.479 11.565 8.296 4.308-1.77 23.688 2.2 22.301 3.595 6.441-6.479 17.918-3.357 25.606-8.02 6.694-4.059 10.997-11.797 10.38-19.87-0.465-6.094-2.945-13.041 1.775-17.781 3.619-3.634 7.789-7.309 9.324-12.126-3.418 0.259-6.364 1.086-9.691 2.09-9.078 2.738-2.814-0.325-6.831-3.197 0.198 0.142-2.735-10.104-7.712-4.979-1.68 1.74-1.74 4.45-1.1 6.65"
  />
</symbol>


      </defs>
    </svg>
    <div id="root"></div>
    <template id="start">
      <div class="start">
        <h1>
          <span class="character-name"></span> in the dark
        </h1>
        <div class="character-chooser">
          <div class="character-chooser__character" data-character="donkey">
            <svg>
              <use xlink:href="#donkey"></use>
            </svg>
            <button onclick="gameController.play('donkey')">Play</button>
          </div>
          <div class="character-chooser__character" data-character="dinosaur">
            <svg>
              <use xlink:href="#dinosaur"></use>
            </svg>
            <button onclick="gameController.play('dinosaur')">Play</button>
          </div>
          <div class="character-chooser__character" data-character="duck">
            <svg>
              <use xlink:href="#duck"></use>
            </svg>
            <button onclick="gameController.play('duck')">Play</button>
          </div>
        </div>
      </div>
    </template>
    <template id="game">
      <div class="game">
        <svg class="character">
          <use xlink:href="#donkey"></use>
        </svg>
      </div>
    </template>
    <template id="play-again">
      <div class="play-again">
        <h1>Great job!</h1>
        <button onclick="gameController.start()">Play Again</button>
      </div>
    </template>
    <script id="GameState">
      // Represents the game board before client-specific resizing
      class GameState {
        constructor() {
          this.map = {
            width: 1000,
            height: 1000
          };

          this.flashlight = {
            width: 100,
            height: 100
          };

          this.character = {
            width: 100,
            height: 100,
            x: 0,
            y: 0
          };
        }

        randomizeCharacterLocation() {
          this.character.x = Math.floor(Math.random() * (this.map.width - this.character.width));
          this.character.y = Math.floor(Math.random() * (this.map.height - this.character.height));
        }
      }
    </script>
    <script id="CharacterRotator">
      CharacterRotator = (() => {
        const characterClassName = 'character-chooser__character',
              selectedCharacterClassName = 'character-chooser__character--selected',
              characterSwitchTime = 2000;
              
        let characterRotatorTimerId;

        const _highlightRandomCharacter = () => {
          const characters = Array.from(document.getElementsByClassName(characterClassName));

          const selected = characters.find(c => c.classList.contains(selectedCharacterClassName));
          let selectedIndex = -1;
          if (selected) {
            selected.classList.remove(selectedCharacterClassName);
            selectedIndex = characters.indexOf(selected);
          }

          const nextIndex = selectedIndex == -1 ? 0 : (selectedIndex + 1) % characters.length;
          const newCharacter = characters[nextIndex];
          newCharacter.classList.add(selectedCharacterClassName);
          document.documentElement.style.setProperty('--character', '"' + newCharacter.dataset.character + '"');
        };

        const _timer = () => {
          _highlightRandomCharacter();
          characterRotatorTimerId = setTimeout(_timer, characterSwitchTime);
        };

        const _stopCharacterRotator = () => {
          clearTimeout(characterRotatorTimerId);
        };

        return {
          start() {
            _timer()
          },
          stop() {
            _stopCharacterRotator();
          }
        }
      })();
    </script>
    <script id="DomController">
      class DomController {
        /*
         * clickEventHandler(x,y): Will be called when a click occurs during game play.
         *                         Provides the x and y coordinates of the click.
         * mouseMoveEventHandler(x,y): Will be called when the mouse is moved during game play
         *                             Provides the x and y coordinates of the mouse.
         * resizedEventHandler(width,height): Will be called when the client resizes the browser.
         *                                    Provides the updated width and height.
         */ 
        constructor(clickEventHandler, mouseMoveEventHandler, resizedEventHandler) {
          this._clickEventHandler = clickEventHandler;
          this._mouseMoveEventHandler = mouseMoveEventHandler;
          this._sendResizedEvents = false;

          // trigger the resized event to provide the initial dimensions
          resizedEventHandler(document.documentElement.clientWidth, document.documentElement.clientHeight);
          window.addEventListener('resize', _ => {
            if (!this._sendResizedEvents) {
              return;
            }

            resizedEventHandler(document.documentElement.clientWidth, document.documentElement.clientHeight)
          });
        }

        _swap(child) {
          let root = document.getElementById('root');
          while(root.lastChild && root.removeChild(root.lastChild));
          root.appendChild(child);
        }

        showStart() {
          this._sendResizedEvents = false;

          this._swap(document.getElementById('start').content.cloneNode(true));

          CharacterRotator.start();
        }

        showGame(character) {
          CharacterRotator.stop();

          this._swap(document.getElementById('game').content.cloneNode(true));

          let gameNode = document.querySelector('#root > .game');
          gameNode.querySelector('use').setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', '#' + character);
          gameNode.addEventListener('click', e => this._clickEventHandler(e.clientX, e.clientY));
          gameNode.addEventListener('mousemove', e => this._mouseMoveEventHandler(e.clientX, e.clientY));

          this._sendResizedEvents = true;
        }

        showPlayAgain() {
          CharacterRotator.stop();
          this._sendResizedEvents = false;

          this._swap(document.getElementById('play-again').content.cloneNode(true));
        }        
      }
    </script>
    <script id="StyleController">
      StyleController = (() => {
        const _setCssPropertyPixels = (name, value) => document.documentElement.style.setProperty(name, value + 'px');

        return {
          updateFlashlight(width, height) {
            _setCssPropertyPixels('--flashlight-width', width);
            _setCssPropertyPixels('--flashlight-height', height);
          },
          updateCharacter(width, height, x, y) {
            _setCssPropertyPixels('--character-width', width);
            _setCssPropertyPixels('--character-height', height);
            _setCssPropertyPixels('--character-x', x);
            _setCssPropertyPixels('--character-y', y);
          },
          updateCursor(x, y) {
            _setCssPropertyPixels('--cursor-x', x);
            _setCssPropertyPixels('--cursor-y', y);
          }
        }
      })();
    </script>
    <script id="GameController">
      class GameController {
        constructor() {
          this._gameState = new GameState();
          this._domController = new DomController(
            this._handleClick.bind(this),
            this._handleMouseMove.bind(this),
            this._updateClientSize.bind(this));
        }

        _updateClientSize(width, height) {
          const factor = {
            width: width / this._gameState.map.width,
            height: height / this._gameState.map.height
          };

          const flashlight = {
            width: this._gameState.flashlight.width * factor.width,
            height: this._gameState.flashlight.height * factor.height
          };

          const character = {
            width: this._gameState.character.width * factor.width,
            height: this._gameState.character.height * factor.height,
            x: this._gameState.character.x * factor.width,
            y: this._gameState.character.y * factor.height
          };

          StyleController.updateFlashlight(flashlight.width, flashlight.height);
          StyleController.updateCharacter(character.width, character.height, character.x, character.y);

          this._factor = factor;
          this._character = character;
        }

        _updateCharacterLocation() {
          this._character.x = this._gameState.character.x * this._factor.width;
          this._character.y = this._gameState.character.y * this._factor.height;
          StyleController.updateCharacter(this._character.width, this._character.height, this._character.x, this._character.y);
        }

        _areCoordinatesOnCharacter(x, y) {
          return this._character.x < x && x < this._character.x + this._character.width
              && this._character.y < y && y < this._character.y + this._character.height;
        }

        _handleClick(x, y) {
          if (this._character.x < x && x < this._character.x + this._character.width
           && this._character.y < y && y < this._character.y + this._character.height) {
            this._domController.showPlayAgain();
          }
        }

        _handleMouseMove(x, y) {
          StyleController.updateCursor(x, y);
        }

        start() {
          this._domController.showStart();
        }

        play(character) {
          this._gameState.randomizeCharacterLocation();
          this._updateCharacterLocation();
          this._domController.showGame(character);
        }
      }
    </script>
    <script id="onLoad">
      (() => {
        // NOTE: The buttons on the start and play-again pages use the gameController directly
        window.gameController = new GameController();
        window.gameController.start();
      })();
    </script>
  </body>
</html>
